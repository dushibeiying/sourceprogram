<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>register</title>

<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" />
<link rel="stylesheet" href="assets/global/bootstrapvalidator-0.4.5/src/css/bootstrapValidator.css" />

<script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script type="text/javascript" src="assets/global/bootstrapvalidator-0.4.5/src/js/bootstrapValidator.js"></script>
<style>
h1{
  background-color:#00ff00;
}
</style>
</head>
<body>
<div class="container">	
  <div class="col-sm-2">   
  </div>
  <div class="col-sm-8">
   	 <h1>欢迎注册原计划！成为拯救人类的英雄吧!</h1>	 
 	 <div class="col-sm-8">	
 	 <form class="form-horizontal form-signin" role="form" id="defaultForm">	    
		  <div class="form-group">
		    <label for="mobile" class="col-sm-4 control-label">*手机号码</label>
		    <div class="col-sm-8">
		      <input type="text" class="form-control" id="mobile">
		      <div id="mobileTips" class="tips">
				<span class="txt-tips">请填写手机号码</span>
			  </div> 
		    </div>    
		  </div>
		  <div class="form-group">
		    <label for="password" class="col-sm-4 control-label">*密码</label>
		    <div class="col-sm-8">
		      <input type="password" class="form-control" id="password">
		      <div id="passwordTips" class="tips">
		        <span class="txt-tips">6~16个字符，区分大小写</span>
		      </div> 
		    </div> 
		  </div>
		  <div class="form-group">
		    <label for="repassword" class="col-sm-4 control-label">*确认密码</label>
		    <div class="col-sm-8">
		      <input type="password" class="form-control" id="repassword">
		      <div id="passwordTips" class="tips">
		        <span class="txt-tips">请再次填写密码</span>
		      </div> 
		    </div>   
		  </div>
		  <div class="form-group">	    
		    <label for="nickname" class="col-sm-4 control-label">昵称</label>
		    <div class="col-sm-8">
		      <input type="text" class="form-control" id="nickname">
		      <div id="nicknameTips" class="tips">
		        <span class="txt-tips">写下自己喜欢的名字</span>
		      </div> 
		    </div>   
		  </div>
		   <div class="form-group">
		    <div class="col-sm-4 control-label">
		    </div>
		    <div class="col-sm-8">
		      <div class="checkbox">
		        <label>
		          <input type="checkbox"> 已查阅并同意<a href="http://reg.email.163.com/unireg/call.do?cmd=register.entrance&from=126mail" target="_blank">协议</a>
		        </label>
		      </div>
		    </div>
		  </div>
		  <div class="form-group">
		    <div class="col-sm-4 control-label">
		    </div>
		    <div class="col-sm-8">
		      <div>
		        <button type="submit" id="submit" class="btn btn-default">立即注册</button>	    
		      </div>
		    </div>
		  </div>
		  		  
		</form>		 
	</div>
	
	<div class="col-sm-4 hidden-xs">
		<img src="http://img.mukewang.com/52b4113500018cf102000200.jpg" class="img-responsive">
		 欢迎注册原计划！成为拯救人类的英雄吧 !
		<a href="index.html">已经是英雄，去登陆</a>
	</div>
  </div>
  <div class="col-sm-2">   
  </div>
</div>
<script>
$(function(){/* 文档加载，执行一个函数*/
     $('#defaultForm').bootstrapValidator({
         message: 'This value is not valid',
          feedbackIcons: {/*输入框不同状态，显示图片的样式*/
                valid: 'glyphicon glyphicon-ok',
                invalid: 'glyphicon glyphicon-remove',
                validating: 'glyphicon glyphicon-refresh'
            },
         fields: {/*验证：规则*/
             mobile: {//验证input项：验证规则
                 message: 'The mobile is not valid',
                
                 validators: {
                     notEmpty: {//非空验证：提示消息
                         message: '用户名不能为空'
                     }
                   }
             },
             password: {
                 message:'密码无效',
                 validators: {
                     notEmpty: {
                         message: '密码不能为空'
                     },
                     stringLength: {
                         min: 6,
                         max: 30,
                         message: '用户名长度必须在6到30之间'
                     },
                     identical: {//相同
                         field: 'password', //需要进行比较的input name值
                         message: '两次密码不一致'
                     },
                     different: {//不能和用户名相同
                         field: 'username',//需要进行比较的input name值
                         message: '不能和用户名相同'
                     },
                     regexp: {
                         regexp: /^[a-zA-Z0-9_\.]+$/,
                         message: 'The username can only consist of alphabetical, number, dot and underscore'
                     }
                 }
             },
             repassword: {
                 message: '密码无效',
                 validators: {
                     notEmpty: {
                         message: '用户名不能为空'
                     },
                     stringLength: {
                         min: 6,
                         max: 30,
                         message: '用户名长度必须在6到30之间'
                     },
                     identical: {//相同
                         field: 'password',
                         message: '两次密码不一致'
                     },
                     different: {//不能和用户名相同
                         field: 'username',
                         message: '不能和用户名相同'
                     },
                     regexp: {//匹配规则
                         regexp: /^[a-zA-Z0-9_\.]+$/,
                         message: 'The username can only consist of alphabetical, number, dot and underscore'
                     }
                 }
             },
          },
          submitHandler : function(validator, form, submitButton) {
          	$.ajax({
		        type: "POST",
		        url: "http://localhost:80/rest/users/register",
		        contentType: "application/json; charset=utf-8",
		        data: JSON.stringify({"mobile":$("#mobile").val(),"password":$("#password").val(),"nickname":$("#nickname").val()}),
		        dataType: "json",
		        success: function (data) {
		            console.log(data);
		            if(data.code == 0){
		            	alert("注册成功");
		            	  $(function () {
		                          location.href = "/index.html";                
		                        })
		            } else if(data.code == 10000){
		            	alert("请输入您的手机号码");
		            } else if (data.code == 10001){
		            	alert("帐号已存在");
		            } else {
		            }
		            
		            validator.resetForm();
		        }
		    });
          }
            
      });
});
</script>
</body>
</html>